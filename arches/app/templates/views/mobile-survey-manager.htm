<!--
ARCHES - a program developed to inventory and manage immovable cultural heritage.
Copyright (C) 2013 J. Paul Getty Trust and World Monuments Fund

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program. If not, see <http://www.gnu.org/licenses/>.
-->
{% extends "base-manager.htm" %}
{% load staticfiles %}
{% load i18n %}


{% block title %}
{{ block.super }}
{% trans "Mobile Survey Manager" %}
{% endblock title %}


{% block main_content %}
<div class="content-panel mobile-project-manager-editor">
    <div class="flex">

        <!-- Left Panel: Groups/Accounts -->
        <div class="left-column-container panel ep-card-tools-panel" style="flex: 0 0 270px;">

            <!-- Title Block -->
            <div class="title-block-title">
                <div class="layer-list">
                    <!-- Layer Filter -->
                    <div class="list-filter" data-bind="" style="margin-right: 10px;">
                        <div class="mpm-title-block">
                            <h4 class="title-block-title">{% trans 'Surveys' %}</h4>
                            <button id="" class="btn btn-lg btn-mint btn-active-dark btn-labeled ion-plus-round" data-bind="click: newProject">{% trans "New Survey" %}</button>
                        </div>
                        <input type="text" class="form-control" style="width: 250px;" placeholder="{% trans 'Find a survey...' %}" data-bind="value: projectFilter, valueUpdate: 'keyup'">

                        <!-- Clear Search -->
                        <span class="clear-node-search" data-bind="visible: projectFilter().length > 0, click: function() { projectFilter(''); }"><i class="fa fa-times-circle"></i></span>
                    </div>

                </div>
            </div>



            <!-- Survey Listing Panel-->
            <div id="user-grid" class="grid" style="position: relative; height: 0px; margin-left: -7px; display:none;" data-bind="visible: true">

                <!-- ko if: projects().length ===  0 -->
                <div id="default-message-panel" class="left-column-message" style="">
                    {% trans "You haven't saved any surveys." %}
                    <p class="default-message">
                        {% trans "Use the form to set up a survey, then save your edits, and you're done!" %}
                    </p>
                </div>
                <!-- /ko -->

                <!-- ko if: projects().length >  0 -->
                <div id="project-listing-panel" class="library-card library-card-entry library-card-wide selected" style="width: 270px;">
                    <!-- ko foreach: filteredProjects() -->
                    <div class="library-card selected selected-card" data-bind="css: {'selected-card': $parent.selectedProject()===$data, 'inactive': !active()}, click: function (p) { $parent.selectedProject(null);$parent.selectedProject(p); }" style="width: 270px;">
                        <div class="mpm-project-card">
                            <a class="mpm-project-name" data-bind="text: name() === '' ? '{% trans "Unnamed Survey" %}' : name()"></a>
                        </div>
                        <div class="mpm-project-status" data-bind="text: active() ? '{% trans "Active" %}' : '{% trans "Inactive" %}'"></div>
                        <a class="mpm-project-delete" data-bind="click: function(val){$parent.deleteProject(val)}, clickBubble: false, css: {'disabled': active()}" href="" class="" aria-expanded="true">{% trans 'delete' %}</a>
                        <div class="mpm-project-subtitle" data-bind="text: createdbyName"></div>
                    </div>
                    <!-- /ko -->
                </div>
                <!-- /ko -->
            </div>
        </div>


        <div id="" class="card-form-preview-container library-container">
            <div class="">

                <!-- Header -->
                <div class="relative library-header" style="height: 55px;">

                    <!-- Add Project -->
                    <div class="library-panel-search-bar">
                        <!--ko if: selectedProject()-->
                        <button id="" class="btn btn-lg btn-danger btn-active-dark btn-labeled ion-minus-round" data-bind="click: deleteSelectedProject">{% trans "Delete Survey" %}</button>
                        <!--/ko-->
                    </div>
                </div>

                <div id="page-content" class="library-grid" style="display:none;" data-bind="visible: true">

                    <!-- ko if: selectedProject() -->
                    <div id="sample-project" class="project-panel">

                        <!--Project heading-->
                        <div class="project-panel-header edit-mode">
                            <h3 class="project-panel-title" data-bind="text: selectedProject().name() === '' ? '{% trans "Unnamed Survey" %}' : selectedProject().name()"></h3>
                            <ul class="msm-edit-buttons">
                                <button id="btn-save-edits" class="btn btn-primary btn-labeled btn-active-dark fa fa-check" data-bind="click: saveProject, css: {'disabled': selectedProject().dirty()==false}">{% trans 'Save Edits' %}</button>
                                <button class="btn btn-danger btn-labeled btn-active-dark fa fa-undo" data-bind="click: discardEdits, css: {'disabled': selectedProject().dirty()==false}">{% trans 'Discard Edits' %}</button>
                            </ul>

                            <div class="">
                                <div class="project-details">
                                    <div class="project-status" data-bind="css: selectedProject().active() ? 'active' : 'inactive', text: selectedProject().active() ? '{% trans "Active" %}' : '{% trans "Inactive" %}'"></div>
                                    <li class="project-metadata-item">
                                        <span data-bind="text: selectedProject().startdate() || '?'"></span>
                                        {% trans 'to' %}
                                        <span data-bind="text: selectedProject().enddate() || '?'"></span>
                                    </li>
                                </div>
                            </div>
                        </div>

                        <!--Project Details-->
                        <div id="project-details" class="project-panel-body" style="">

                            <div id="card-preview-crud" class="panel-body card-body fade in" style="padding: 0px; margin: 0px;">
                                <div id="cards" class="tab-base card-content-container outline" style="margin: 0px; margin-top: 0px;">

                                    <!--Nav Tabs-->
                                    <ul class="nav nav-tabs card-nav-container" style="">
                                        <li id="summary-group" class="active">
                                            <a id="summary-tab" data-toggle="tab" href="#summary-card" class="card-tab-title" aria-expanded="true">
                                                                {% trans 'Basic Settings' %}
                                                            </a>
                                        </li>
                                        <li id="card-group" class="">
                                            <a id="map-tab" data-toggle="tab" href="#location-card" class="card-tab-title" aria-expanded="false">
                                                                {% trans 'Location' %}
                                                            </a>
                                        </li>
                                        <li id="icon-group" class="">
                                            <a id="map-tab" data-toggle="tab" href="#models-card" class="card-tab-title" aria-expanded="false">
                                                                {% trans 'Resources' %}
                                                            </a>
                                        </li>
                                        <li id="icon-group" class="">
                                            <a id="map-tab" data-toggle="tab" href="#data-card" class="card-tab-title" aria-expanded="false">
                                                                {% trans 'Data' %}
                                                            </a>
                                        </li>
                                        <li id="status-group" class="">
                                            <a id="map-tab" data-toggle="tab" href="#identities-card" class="card-tab-title" aria-expanded="false">
                                                                {% trans 'People' %}
                                                            </a>
                                        </li>
                                        <li id="activation-group" class="">
                                            <a id="project-summary-tab" data-toggle="tab" href="#project-summary-card" class="card-tab-title" aria-expanded="false">
                                                                {% trans 'Activate Survey' %}
                                                            </a>
                                        </li>
                                    </ul>

                                    <!--Tabs Content-->
                                    <div class="tab-content card-content-tab" style="margin-left: 0px;">

                                        <!-- Summary Card -->
                                        <div id="summary-card" class="mpm-card tab-pane fade active in" style="">
                                            <div class="panel-body card-panel-body project-card-body">
                                                <div id="" class="card-content">

                                                    <!-- Project Info -->
                                                    <section id="" class="profile-list edit-mode">
                                                        <div class="account-wrapper">
                                                            <div class="row relative">


                                                                <!-- Section Content -->
                                                                <div class="col-sm-12">

                                                                    <div id="account-crud" class="" style="">
                                                                        <div class="row">
                                                                            <div class="col-sm-5">
                                                                                <div class="form-group">
                                                                                    <label class="control-label account-label">{% trans 'Survey name' %}</label>
                                                                                    <input type="text" class="form-control input-lg account-input" data-bind="value: selectedProject().name, valueUpdate: 'keyup'">
                                                                                </div>
                                                                            </div>

                                                                            <div class="col-sm-6">
                                                                                <p class="account-tips">
                                                                                    {% trans 'Pick a concise name that makes it easy for people to find your survey' %}
                                                                                </p>
                                                                            </div>
                                                                        </div>

                                                                        <hr style="border-color: #eee;">

                                                                        <div class="row">
                                                                            <div class="col-sm-5">
                                                                                <div class="form-group">
                                                                                    <label class="control-label account-label">{% trans 'Survey start date' %}</label>
                                                                                    <input class="form-control input-lg account-input" data-bind="datepicker: {format: dateFormat, minDate: false, maxDate: selectedProject().enddate}, value: selectedProject().startdate">
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-sm-6">
                                                                                <p class="account-tips">
                                                                                    {% trans 'The survey start and end dates are used to limit when people can add or edit Arches data.' %}
                                                                                </p>
                                                                            </div>
                                                                        </div>

                                                                        <div class="row">
                                                                            <div class="col-sm-5">
                                                                                <div class="form-group">
                                                                                    <label class="control-label account-label">{% trans 'Survey end' %}</label>
                                                                                    <input class="form-control input-lg account-input" data-bind="datepicker: {format: dateFormat, minDate: selectedProject().startdate, maxDate: false}, value: selectedProject().enddate">
                                                                                </div>
                                                                            </div>
                                                                        </div>

                                                                        <hr style="border-color: #eee;">

                                                                        <div class="row">
                                                                            <div class="col-sm-12">
                                                                                <div class="form-group">
                                                                                    <label class="control-label account-label">{% trans 'Description' %}</label>
                                                                                    <div>
                                                                                        <textarea class="form-control textarea textarea-resizable" rows="3" type="text" data-bind="value: selectedProject().description, valueUpdate: 'keyup'"></textarea>
                                                                                    </div>
                                                                                </div>
                                                                            </div>

                                                                        </div>

                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </section>

                                                </div>
                                            </div>
                                        </div>

                                        <!-- Map Card -->
                                        <div id="location-card" class="mpm-card tab-pane fade">
                                            Location....
                                        </div>

                                        <!-- Models Card -->
                                        <div id="models-card" class="identities-list tab-pane fade">
                                            <div>
                                                <div>
                                                    <div class="flex relative">

                                                        <div class="msm-resource-panel" style="" data-bind="with:resourceList">
                                                            {% include 'views/mobile-survey-manager/resource-list.htm' %}
                                                        </div>

                                                        <div class="msm-resource-cards" data-bind="style: {top: (resourceList.selectedIndex() * 60 + 120) + 'px' }, visible: resourceList.selected() && resourceList.hideResourceList() != true">

                                                            <div class="relative">
                                                                <!--ko if: resourceList.selected() -->
                                                                 <!--ko if: resourceList.selected().cards().length > 0 -->
                                                                 <div class="msm-card-toolbar">
                                                                     <h4 class="mpm-item-listing-header">{% trans 'Data Entry Forms' %}</h4>
                                                                     <div class="mpm-card-filter">
                                                                         <input class="form-control input-lg" placeholder="{% trans 'find a form...' %}" type="text" data-bind="value: resourceList.cardFilter, valueUpdate: 'keyup', event: {keyup: function(val){console.log('thest')}}">
                                                                     </div>
                                                                 </div>
                                                                <div class="mpm-card-container">
                                                                    <div class="mpm-card-list available">
                                                                    <div class="mpm-card-list-header">{% trans 'Available to Add' %}</div>
                                                                    <div class="mpm-card-list-items">
                                                                    <div data-bind="sortable: {data:resourceList.selected().cards, afterMove: selectedProject().updateUnapproved,  addToSelf: true}" class="ko_container ui-sortable">
                                                                        <div class="list-group-item get-user-detail" data-bind="click: function(){ $data.expanded(!$data.expanded()) }, visible: ($data.filtered() === false && $data.approved() === false)">
                                                                            <div class="mpm-user-title mpm-user-name">
                                                                                <h4 data-bind='text: $data.name'></h4>
                                                                            </div>
                                                                            <p class="mpm-user-subtitle resource"><span>{% trans 'Fields:' %}</span><span class="mpm-widget-labels" data-bind="text: $data.widgetlabels"></span></p>

                                                                            <div class="mpm-user-summary" data-bind="css: {'expanded': $data.expanded()}">
                                                                                <!-- ko foreach: { data:$data.nodes, as: 'node'} -->
                                                                                <!--ko if: node.datatype != 'semantic' -->
                                                                                <div class="mpm-model-detail-panel">
                                                                                    <div class="mpm-node-name" data-bind="text:node.name"></div>
                                                                                    <ul class="mpm-node-detail-metadata">
                                                                                        <li class=""><span>{% trans 'Type: ' %}</span><span data-bind="text:node.datatype"></span></li>
                                                                                        <li class=""><span>{% trans 'Required: ' %}</span><span data-bind="text: node.isrequired ? 'Yes' : 'No'"></span></li>
                                                                                    </ul>
                                                                                </div>
                                                                                <!--/ko-->
                                                                                <!--/ko-->
                                                                            </div>

                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                    </div>
                                                                    <div class="mpm-card-list approved">
                                                                    <div class="mpm-card-list-header">{% trans 'Added to Survey' %}</div>
                                                                    <div class="mpm-card-list-items">
                                                                    <div data-bind="sortable: {data: resourceList.selected().cards, afterMove: selectedProject().updateApproved, addToSelf: true}" class="ko_container ui-sortable" style="min-height:100%">
                                                                        <div class="list-group-item get-user-detail" data-bind="click: function(){ $data.expanded(!$data.expanded()) }, visible: ($data.approved() === true)">
                                                                            <div class="mpm-user-title mpm-user-name">
                                                                                <h4 data-bind='text: $data.name'></h4>
                                                                            </div>
                                                                            <p class="mpm-user-subtitle resource"><span>{% trans 'Fields:' %}</span><span class="mpm-widget-labels" data-bind="text: $data.widgetlabels"></span></p>


                                                                            <div class="mpm-user-summary" data-bind="css: {'expanded': $data.expanded()}">
                                                                                <!-- ko foreach: { data:$data.nodes, as: 'node'} -->
                                                                                <!--ko if: node.datatype != 'semantic' -->
                                                                                <div class="mpm-model-detail-panel">
                                                                                    <div class="mpm-node-name" data-bind="text:node.name"></div>
                                                                                    <ul class="mpm-node-detail-metadata">
                                                                                        <li class=""><span>{% trans 'Type: ' %}</span><span data-bind="text:node.datatype"></span></li>
                                                                                        <li class=""><span>{% trans 'Required: ' %}</span><span data-bind="text: node.isrequired ? 'Yes' : 'No'"></span></li>
                                                                                    </ul>
                                                                                </div>
                                                                                <!--/ko-->
                                                                                <!--/ko-->
                                                                            </div>


                                                                        </div>
                                                                    </div>
                                                                    </div>
                                                                    </div>
                                                                </div>
                                                                <!--/ko-->
                                                                <!--/ko-->

                                                            </div>
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Data Card -->
                                        <div id="data-card" class="mpm-card tab-pane fade">
                                            Data...
                                        </div>

                                        <div id="identities-card" class="identities-list mpm-card tab-pane fade">

                                            <div>
                                                <div>
                                                    <div class="flex relative">

                                                        <div class="mpm-left-panel" style="" data-bind="with:identityList">
                                                            {% include 'views/mobile-survey-manager/identity-list.htm' %}
                                                        </div>

                                                        <div class="mpm-right-panel">

                                                            <div class="relative">

                                                                <div class="row">
                                                                    <div class="col-xs-12 col-sm-5 col-md-3">
                                                                        <!-- ko if: identityList.selected().type === 'group' -->
                                                                        <span class="icon-wrap icon-wrap-sm icon-circle branch-icon bg-purple">
                                                                            <i class="fa fa-group"></i>
                                                                        </span>
                                                                        <div class="mpm-group-name">
                                                                            <a class="listitem_name" data-bind='text:identityList.selected().name'></a>
                                                                        </div>
                                                                        <div class="mpm-group-subtitle">{% trans 'Arches Group' %} </div>
                                                                        <!-- /ko -->
                                                                        <!-- ko if: identityList.selected().type === 'user' -->
                                                                        <span class="icon-wrap icon-wrap-sm icon-circle branch-icon bg-mint">
                                                                            <i class="fa fa-user"></i>
                                                                        </span>
                                                                        <div class="mpm-group-name">
                                                                            <a class="listitem_name" data-bind='text:identityList.selected().name'></a>
                                                                        </div>
                                                                        <div class="mpm-group-subtitle" data-bind="">{% trans 'Arches User' %}</div>
                                                                        <!-- /ko -->
                                                                    </div>
                                                                    <div class="col-sm-6" style="" data-bind="">
                                                                        <div class="box-inline">

                                                                            <!-- ko if: identityList.selected().type === 'user' -->
                                                                            <div class="">
                                                                                <span class="switch switch-small mpm-account-switch" data-bind="css: {'on': selectedProject().hasIdentity()}, click: function(){selectedProject().toggleIdentity()}"><small></small>

                                                                                </span>
                                                                                <p class="mpm-account-switch-text" style="margin-bottom: 0px;">{% trans 'Add this user to survey' %}</p>
                                                                                        <div style="display:flex; flex-direction:row;">
                                                                                        <div class="arches-toggle-sm"></div>
                                                                                            <div style="margin-top: -17px;"></div>
                                                                                        </div>
                                                                                <span class="arches-toggle-subtitle"></span>
                                                                            </div>
                                                                            <!-- /ko -->

                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                <!-- Users in this Account -->
                                                                <div class="mpm-account-detail-panel">

                                                                    <!-- User Listing -->
                                                                    <div id="user-cards" class="list-group user-cards">
                                                                        <!-- Title/Filter/Pagination -->
                                                                        <!--ko if: identityList.selected().type === 'group' -->
                                                                        <div class="relative mpm-item-listing-header-panel">

                                                                            <div class="mpm-toggle-container">
                                                                                <span class="switch switch-small" data-bind="css: {'on': selectedProject().hasIdentity()}, click: function(){selectedProject().toggleIdentity()}"><small></small></span>

                                                                                <h4 class="mpm-item-listing-header">{% trans 'Add accounts in this group' %}</h4>
                                                                            </div>

                                                                            <div class="project-search-widget mpm-item-listing">
                                                                                <input class="form-control input-lg" placeholder="{% trans 'find a user in this group...' %}"  type="text" data-bind="value: selectedProject().userFilter, valueUpdate: 'keyup'">
                                                                            </div>
                                                                        </div>
                                                                        <div class='mpm-group-users'>
                                                                        <!-- ko foreach: selectedProject().filteredUsers() -->
                                                                            <div href="#" class="list-group-item get-user-detail" data-bind="click: function(){ $data.expanded(!$data.expanded()) }">
                                                                                <div class="mpm-user-title mpm-user-name"><h4 data-bind='text: $data.username'></h4>
                                                                                <!--ko if: $data.groups-->
                                                                                    <!--ko if: _.contains($parent.selectedProject().users(), $data.id) -->
                                                                                    <div class='mpm-user-status invited pull-right'>
                                                                                        <span>{% trans 'Approved' %}</span>
                                                                                    </div>
                                                                                    <!--/ko-->
                                                                                    <!--ko ifnot: _.contains($parent.selectedProject().users(), $data.id) -->
                                                                                    <div class='mpm-user-status pull-right'>
                                                                                        <span>{% trans 'Not Approved' %}</span>
                                                                                    </div>
                                                                                    <!--/ko-->
                                                                                <!--/ko-->
                                                                            </div>
                                                                                <div class="mpm-user-subtitle"><p>{% trans 'Activity: 0 edits' %}</p><div><span>{% trans 'Last Login:' %}</span><span class="last-login" data-bind="text: $data.last_login"></span></div></div>
                                                                                <div class="mpm-user-summary" data-bind="css: {'expanded': $data.expanded()}">
                                                                                    <div class="mpm-model-detail-panel">
                                                                                        <div class="mpm-node-name">
                                                                                            {% trans 'User Information' %}
                                                                                        </div>
                                                                                        <ul class="mpm-node-detail-metadata">
                                                                                            <li class="">
                                                                                                <span>{% trans 'Name:' %}
                                                                                                    <span class="last-login" data-bind="text: $data.first_name"></span>
                                                                                                    <span class="last-login" data-bind="text: $data.last_name"></span>
                                                                                                </span>
                                                                                            </li>
                                                                                            <li class="">
                                                                                                {% trans 'Email:' %} <a href="" data-bind="text: $data.email"></a>
                                                                                            </li>
                                                                                            <li class="">
                                                                                                {% trans 'Groups:' %}
                                                                                                <span class="last-login" data-bind="text: $data.group_names"></span>
                                                                                            </li>
                                                                                        </ul>
                                                                                    </div>

                                                                                    <div class="mpm-model-detail-panel">
                                                                                        <div class="mpm-node-name">
                                                                                            Contributions
                                                                                        </div>
                                                                                        <ul class="mpm-node-detail-metadata">
                                                                                            <li class="">
                                                                                                Edits: 0
                                                                                            </li>
                                                                                            <li>
                                                                                                Devices (1)
                                                                                                <ul class="mpm-node-detail-metadata">
                                                                                                    <li class="">
                                                                                                        <span>Name: iPhone (last login:<span class="last-login" data-bind="text: $data.last_login"></span>)</span>
                                                                                                    </li>
                                                                                                </ul>
                                                                                            </li>
                                                                                        </ul>
                                                                                    </div>

                                                                                    <div class="mpm-model-detail-panel">
                                                                                        <div class="mpm-node-name">
                                                                                            Security
                                                                                        </div>
                                                                                        <ul class="mpm-node-detail-metadata">
                                                                                            <li class="">
                                                                                                Remove survey data from from user's device on next login?
                                                                                            </li>
                                                                                            <li class="">
                                                                                                <!--Switchery : Unchecked-->
                                                                                                <!--===================================================-->
                                                                                                <input id="wipe-project" class="js-switch-small" type="checkbox" style="margin-top: 0px; display: none;" data-switchery="true"><span class="switchery switchery-small" style="box-shadow: rgb(223, 223, 223) 0px 0px 0px 0px inset; border-color: rgb(223, 223, 223); background-color: rgb(255, 255, 255); transition: border 0.4s, box-shadow 0.4s;"><small style="left: 0px; background-color: rgb(255, 255, 255); transition: left 0.2s;"></small></span>
                                                                                                <!--===================================================-->
                                                                                            </li>
                                                                                        </ul>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        <!-- /ko -->
                                                                    </div>
                                                                        <!--/ko-->
                                                                        <!--ko if: identityList.selected().type === 'user' -->
                                                                        <a href="#" class="get-user-detail">
                                                                            <div class="mpm-user-title mpm-user-name">
                                                                                    <!--ko if: identityList.selected().approved() -->
                                                                                    <div class='mpm-user-status invited user'>
                                                                                        <span>{% trans 'Approved' %}</span>
                                                                                    </div>
                                                                                    <!--/ko-->
                                                                                    <!--ko ifnot: identityList.selected().approved() -->
                                                                                    <div class='mpm-user-status user pull-right'>
                                                                                        <span>{% trans 'Not Approved' %}</span>
                                                                                    </div>
                                                                                    <!--/ko-->
                                                                            </div>
                                                                                <div class="mpm-user-subtitle user">
                                                                                    <div class="mpm-user-summary">
                                                                                        <div class="mpm-model-detail-panel">
                                                                                            <div class="mpm-node-name">
                                                                                                {% trans 'User Information' %}
                                                                                            </div>
                                                                                            <ul class="mpm-node-detail-metadata">
                                                                                                <li class="">
                                                                                                    <span>{% trans 'Name:' %}
                                                                                                        <span class="last-login" data-bind="text: identityList.selected().first_name"></span>
                                                                                                        <span class="last-login" data-bind="text: identityList.selected().last_name"></span>
                                                                                                    </span>
                                                                                                </li>
                                                                                                <li class="">
                                                                                                    {% trans 'Email:' %} <a href="" data-bind="text: identityList.selected().email"></a>
                                                                                                </li>
                                                                                                <li class="">
                                                                                                    {% trans 'Groups:' %}
                                                                                                    <span class="last-login" data-bind="text: identityList.selected().groups"></span>
                                                                                                </li>
                                                                                            </ul>
                                                                                        </div>

                                                                                        <div class="mpm-model-detail-panel">
                                                                                            <div class="mpm-node-name">
                                                                                                Contributions
                                                                                            </div>
                                                                                            <ul class="mpm-node-detail-metadata">
                                                                                                <li class="">
                                                                                                    Edits: 0
                                                                                                </li>
                                                                                                <li>
                                                                                                    Devices (1)
                                                                                                    <ul class="mpm-node-detail-metadata">
                                                                                                        <li class="">
                                                                                                            <span>Name: iPhone (last login:<span class="last-login" data-bind="text: identityList.selected().last_login"></span>)</span>
                                                                                                        </li>
                                                                                                    </ul>
                                                                                                </li>
                                                                                            </ul>
                                                                                        </div>

                                                                                        <div class="mpm-model-detail-panel">
                                                                                            <div class="mpm-node-name">
                                                                                                Security
                                                                                            </div>
                                                                                            <ul class="mpm-node-detail-metadata">
                                                                                                <li class="">
                                                                                                    Remove survey data from from user's device on next login?
                                                                                                </li>
                                                                                                <li class="">
                                                                                                    <!--Switchery : Unchecked-->
                                                                                                    <!--===================================================-->
                                                                                                    <input id="wipe-project" class="js-switch-small" type="checkbox" style="margin-top: 0px; display: none;" data-switchery="true"><span class="switchery switchery-small" style="box-shadow: rgb(223, 223, 223) 0px 0px 0px 0px inset; border-color: rgb(223, 223, 223); background-color: rgb(255, 255, 255); transition: border 0.4s, box-shadow 0.4s;"><small style="left: 0px; background-color: rgb(255, 255, 255); transition: left 0.2s;"></small></span>
                                                                                                    <!--===================================================-->
                                                                                                </li>
                                                                                            </ul>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div>

                                                                                </div>
                                                                            </div>
                                                                            </a>

                                                                        <!--ko if: _.filter(identityList.usersGroups(), function(u){return u.approved()}).length > 0 -->
                                                                        <div class="mpm-user-groups">{% trans 'Belongs to the following approved groups:' %}
                                                                            <ul class="user-group-list">
                                                                                <!-- ko foreach: identityList.usersGroups() -->
                                                                                <!-- ko if: $data.approved -->
                                                                                <li>
                                                                                    <span class='mpm-user-subtitle' data-bind="text:$data.name"></span>
                                                                                </li>
                                                                                <!--/ko -->
                                                                                <!--/ko -->
                                                                            </ul>
                                                                        </div>
                                                                        <!--/ko-->
                                                                        <!--/ko-->


                                                                    </div>

                                                                </div>
                                                            </div>
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Summary Card -->
                                        <div id="project-summary-card" class="mpm-card tab-pane fade">
                                            <div class="panel-body card-panel-body" style="">
                                                <div id="" class="card-content" style="">

                                                    <!-- Project Summary Panel -->
                                                    <div class="mpm-activation-panel">
                                                        <!-- Activate Project -->
                                                        <div class="row pad-btm">
                                                            <!-- Activate Switch -->
                                                            <div class="col-sm-5 col-md-3">

                                                                <div class="box-inline">
                                                                    <p class="mpm-item-listing-header" style="margin-bottom: 0px;">{% trans 'Activate Survey' %}</p>

                                                                    <div class="toggle-container">
                                                                        <span class="switch switch-small" data-bind="css: {'on': selectedProject().active()}, click: function(){
                                                                            selectedProject().active(!selectedProject().active());
                                                                        }"><small></small></span>
                                                                    </div>

                                                                </div>
                                                            </div>

                                                            <!-- Help Message-->
                                                            <div class="col-sm-6 col-md-9">
                                                                <p class="account-tips" style="margin-top: 20px;">
                                                                    By activating the survey you will send users an email with the information needed to begin data editing activitites.
                                                                </p>
                                                            </div>
                                                        </div>

                                                        <!-- Survey Settings -->
                                                        <div class="mpm-summary-panel">
                                                            <p class="mpm-item-listing-header" style="margin-bottom: 0px;">
                                                                {% trans 'Summary' %}
                                                            </p>
                                                            <ul class="mpm-node-detail-metadata">
                                                                <li class="">
                                                                    Number of edits: 0
                                                                </li>
                                                                <li class="">
                                                                    Contributors: 0
                                                                </li>
                                                                <li class="">
                                                                    Offline Basemap: Streets-Grey
                                                                </li>
                                                            </ul>
                                                        </div>

                                                        <!-- User Summary -->
                                                        <div class="mpm-summary-panel">
                                                            <p class="mpm-item-listing-header" style="margin-bottom: 0px;">
                                                                {% trans 'Groups/Users' %}
                                                            </p>
                                                            <ul class="mpm-node-detail-metadata">
                                                                <li class="">
                                                                    {% trans 'Groups' %} (<span data-bind="text: selectedProject().approvedGroupNames().length"></span>)
                                                                    <ul class="mpm-node-detail-metadata">
                                                                        <li class="" data-bind="text:  selectedProject().approvedGroupNames().join(', ')">
                                                                        </li>
                                                                    </ul>
                                                                </li>
                                                            </ul>
                                                            <ul class="mpm-node-detail-metadata">
                                                                <li class="">
                                                                    {% trans 'Users' %} (<span data-bind="text: selectedProject().approvedUserNames().length"></span>)
                                                                    <ul class="mpm-node-detail-metadata">
                                                                        <li class="" data-bind="text: selectedProject().approvedUserNames().join(', ')">

                                                                        </li>
                                                                    </ul>
                                                                </li>
                                                            </ul>
                                                        </div>

                                                        <!-- Model/Card Summary -->
                                                        <div class="mpm-summary-panel">
                                                            <p class="mpm-item-listing-header" style="margin-bottom: 0px;">
                                                                {% trans 'Models and Data Entry Cards' %}
                                                            </p>
                                                            <!--ko foreach: {data: resourceList.items, as: 'resource'} -->
                                                                <!--ko if: resource.added() === true -->
                                                                <ul class="mpm-node-detail-metadata">
                                                                    <li class="">
                                                                        <div data-bind="text: resource.name + ' (' + resource.cardcount() + ' data entry cards)'"></div>
                                                                        <!--ko foreach: {data: resource.cards, as: 'card'} -->
                                                                        <ul class="mpm-node-detail-metadata">
                                                                            <!--ko if: card.approved -->
                                                                            <li data-bind="text: card.name"></li>
                                                                            <!--/ko-->
                                                                        </ul>
                                                                        <!--/ko-->
                                                                    </li>
                                                                </ul>
                                                                <!--/ko-->
                                                            <!--/ko-->
                                                        </div>

                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- /ko -->


                </div>
            </div>
        </div>
    </div>
</div>
{% endblock main_content %}

{% block tabs %}{% endblock tabs %}

{% block pre_require_js %}
{{block.super}}
    <script>
        {% autoescape off %}define('mobile-survey-manager-data', [], function() {
            return {
                projects: {{mobile_surveys}},
                resources: {{resources}},
                identities: {{identities}}
            };
        });{% endautoescape %}
    </script>
{% endblock pre_require_js %}
